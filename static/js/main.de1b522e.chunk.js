(this["webpackJsonpsd-0x-project-trybewallet"]=this["webpackJsonpsd-0x-project-trybewallet"]||[]).push([[0],{21:function(e,t,a){e.exports=a.p+"static/media/money.25ea97be.png"},34:function(e,t,a){e.exports=a(55)},39:function(e,t,a){},44:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(20),c=a.n(i),o=a(23),l=(a(39),a(10)),s=a(2),u=a(17),d=a(8),p=a(9),m=a(4),h=a(12),E=a(11),b=function(e){return{type:"REQUEST_API",payload:e}},v=a(21),f=a.n(v),y=(a(44),function(e){Object(h.a)(a,e);var t=Object(E.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={email:"",senha:"",isDisabled:!0},n.handleChange=n.handleChange.bind(Object(m.a)(n)),n.handleClick=n.handleClick.bind(Object(m.a)(n)),n}return Object(p.a)(a,[{key:"handleChange",value:function(e){var t=this,a=e.target,n=a.name,r=a.value;this.setState(Object(u.a)({},n,r),(function(){var e=t.validateUser,a=t.state,n=a.email,r=a.senha;t.setState({isDisabled:!e(n,r)})}))}},{key:"handleClick",value:function(e){e.preventDefault();var t=this.props,a=t.login,n=t.history;a(this.state.email),n.push("/Trybe-Projeto_17-Trybe_Wallet/carteira")}},{key:"validateUser",value:function(e,t){var a=/\S+@\S+\.\S+/.test(e),n=t.length>=6;return a&&n}},{key:"render",value:function(){var e=this.handleChange,t=this.handleClick,a=this.state,n=a.email,i=a.senha,c=a.isDisabled;return r.a.createElement("section",{className:"login-section"},r.a.createElement("form",{method:"get"},r.a.createElement("div",{className:"logo-div"},r.a.createElement("h1",null,"Trybe Wallet"),r.a.createElement("img",{src:f.a,alt:"money-logo"})),r.a.createElement("div",{className:"mb-3"},r.a.createElement("input",{"data-testid":"email-input",className:"form-control",type:"text",value:n,name:"email",placeholder:"Email",onChange:e})),r.a.createElement("div",{className:"mb-3"},r.a.createElement("input",{"data-testid":"password-input",className:"form-control",type:"password",value:i,name:"senha",placeholder:"Senha",onChange:e})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit",onClick:t,disabled:c},"Entrar"))))}}]),a}(r.a.Component)),g=Object(l.b)(null,(function(e){return{login:function(t){return e({type:"LOGIN",payload:t})}}}))(y),O=a(15),j=a.n(O),x=a(19),S=function(){return fetch("https://economia.awesomeapi.com.br/json/all").then((function(e){return e.json()})).then((function(e){return e})).catch((function(){return!1}))},T=(a(46),function(e){Object(h.a)(a,e);var t=Object(E.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).sumExpenseValues=n.sumExpenseValues.bind(Object(m.a)(n)),n}return Object(p.a)(a,[{key:"sumExpenseValues",value:function(){var e=this.props.wallet.expenses.reduce((function(e,t){var a=t.value,n=t.currency,r=t.exchangeRates[n].ask;return e+parseFloat(a)*parseFloat(r)}),0),t=(e=e.toLocaleString("pt-br",{minimumFractionDigits:2,maximumFractionDigits:2})).split(".");return t.splice(0,1),t.splice(t.length-1,1),t.length>3&&(e="".concat(e.split(".")[0]," x 10^").concat(3*t.length+3," +")),e}},{key:"render",value:function(){var e=this.sumExpenseValues,t=this.props.email;return r.a.createElement("header",null,r.a.createElement("div",{className:"logo-div"},r.a.createElement("img",{src:f.a,alt:"money-logo"}),r.a.createElement("h1",null,"Trybe Wallet")),r.a.createElement("div",{className:"email-and-expenses-value-div"},r.a.createElement("p",{"data-testid":"email-field",className:"email-field"},t),r.a.createElement("div",{className:"sum-value-div"},r.a.createElement("p",null,"Despesa Total: "),r.a.createElement("p",{"data-testid":"total-field",className:"sum"},"R$".concat(e())),r.a.createElement("p",{"data-testid":"header-currency-field"},"BRL"))))}}]),a}(r.a.Component)),C=Object(l.b)((function(e){return{email:e.user.user.email,wallet:e.wallet}}))(T),k=function(e){Object(h.a)(a,e);var t=Object(E.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){var e=this.props,t=e.id,a=e.testid,n=e.title,i=e.name,c=e.value,o=e.array,l=e.handleChange;return r.a.createElement("div",{className:"mb-3"},r.a.createElement("label",{htmlFor:t},n),r.a.createElement("select",{id:t,"data-testid":a,name:i,className:"form-control",value:c,onChange:l},o.map((function(e){return r.a.createElement("option",{key:e},e)}))))}}]),a}(r.a.Component),w=(a(47),function(e){Object(h.a)(a,e);var t=Object(E.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"renderSubmitBtn",value:function(e,t,a,n){return t?r.a.createElement("button",{type:"button",className:"edit-btn",onClick:a,disabled:e},"Editar despesa"):r.a.createElement("button",{type:"button",className:"add-btn",onClick:n,disabled:e},"Adicionar despesa")}},{key:"render",value:function(){var e=this.renderSubmitBtn,t=this.props,a=t.handleChange,n=t.handleClick,i=t.confirmEditAndUpdateExpenses,c=this.props,o=c.value,l=c.description,s=c.currency,u=c.method,d=c.tag,p=c.isDisabled,m=this.props.wallet,h=m.currencies,E=m.editor;return r.a.createElement("section",{className:"form-section"},r.a.createElement("form",{method:"get",className:"form"},r.a.createElement("div",{className:"mb-3"},r.a.createElement("label",{htmlFor:"value-input"},"Valor:",r.a.createElement("input",{type:"number",id:"value-input",className:"form-control value-input",name:"value",value:o,"data-testid":"value-input",placeholder:"00.00",onChange:a}))),r.a.createElement("div",{className:"mb-3"},r.a.createElement("label",{htmlFor:"description-input"},"Descri\xe7\xe3o:",r.a.createElement("input",{type:"text",id:"description-input",className:"form-control",name:"description",value:l,"data-testid":"description-input",placeholder:"Sorvete de chocolate",onChange:a}))),r.a.createElement(k,{id:"currencies-select",testid:"currency-input",title:"Moeda:",name:"currency",value:s,array:h,handleChange:a}),r.a.createElement(k,{id:"method-select",testid:"method-input",title:"M\xe9todo de Pagamento:",name:"method",value:u,array:["Dinheiro","Cart\xe3o de cr\xe9dito","Cart\xe3o de d\xe9bito"],handleChange:a}),r.a.createElement(k,{id:"tag-select",testid:"tag-input",title:"Categoria:",name:"tag",value:d,array:["Alimenta\xe7\xe3o","Lazer","Trabalho","Transporte","Sa\xfade"],handleChange:a}),e(p,E,i,n)))}}]),a}(r.a.Component)),N=Object(l.b)((function(e){return{wallet:e.wallet}}))(w),A=function(e){var t=e.wallet.expenses;localStorage.setItem("expenses",JSON.stringify(t))},F=(a(48),function(e){Object(h.a)(a,e);var t=Object(E.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).convertToBrCurrency=function(e){return parseFloat(e).toLocaleString("pt-br",{minimumFractionDigits:2,maximumFractionDigits:2})},n.renderTableRows=n.renderTableRows.bind(Object(m.a)(n)),n.removeAndSaveAtStorage=n.removeAndSaveAtStorage.bind(Object(m.a)(n)),n}return Object(p.a)(a,[{key:"getExpenseInfo",value:function(e){var t=e.value,a=e.description,n=e.currency,r=e.method,i=e.tag,c=e.exchangeRates,o=parseFloat(t).toFixed(2),l=c[n].name,s=parseFloat(c[n].ask);return[a,i,r,o,l,parseFloat(s).toFixed(2),(parseFloat(t)*s).toFixed(2),"Real"]}},{key:"removeAndSaveAtStorage",value:function(){var e=Object(x.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props.removeExpense,e.next=3,a(t);case 3:A(this.props);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderTableRows",value:function(){var e=this.getExpenseInfo,t=this.convertToBrCurrency,a=this.removeAndSaveAtStorage,n=this.props,i=n.expenses,c=n.editor,o=n.idToEdit,l=n.changeThisStateToEdit,s=[3,5,6];return i.map((function(n,i){var u=e(n);return r.a.createElement("tr",{key:n.id,className:c&&o===i?"selected":null},u.map((function(e,a){return r.a.createElement("td",{key:e},s.includes(a)?"".concat(t(e)):e)})),r.a.createElement("td",{className:"td-btn"},c?null:r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{type:"button",className:"edit-btn","data-testid":"edit-btn",onClick:function(){return l(n,i)}},"Editar"),r.a.createElement("button",{type:"button",className:"remove-btn","data-testid":"delete-btn",onClick:function(){return a(i)}},"Excluir"))))}))}},{key:"render",value:function(){var e=this.renderTableRows,t=this.props.errorCurrencyApi;return r.a.createElement("section",{className:"table-section"},r.a.createElement("table",{border:"1"},r.a.createElement("thead",null,r.a.createElement("tr",null,["Descri\xe7\xe3o","Tag","M\xe9todo de pagamento","Valor","Moeda","C\xe2mbio utilizado","Valor convertido","Moeda de convers\xe3o","Editar/Excluir"].map((function(e){return r.a.createElement("th",{key:e},e)})))),r.a.createElement("tbody",null,e())),t?r.a.createElement("p",{className:"erro-currency-api"},"Ops, ocorreu um erro. Tente novamente!"):null)}}]),a}(r.a.Component)),D=Object(l.b)((function(e){return{wallet:e.wallet,expenses:e.wallet.expenses,editor:e.wallet.editor,idToEdit:e.wallet.idToEdit}}),(function(e){return{removeExpense:function(t){return e({type:"REMOVE_EXPENSE",payload:t})}}}))(F),_=(a(49),function(e){Object(h.a)(a,e);var t=Object(E.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={value:"",description:"",currency:"USD",method:"Dinheiro",tag:"Alimenta\xe7\xe3o",isDisabled:!0,errorCurrencyApi:!1},n.localStorageToReduxState=n.localStorageToReduxState.bind(Object(m.a)(n)),n.handleChange=n.handleChange.bind(Object(m.a)(n)),n.handleClick=n.handleClick.bind(Object(m.a)(n)),n.validateForm=n.validateForm.bind(Object(m.a)(n)),n.changeThisStateToEdit=n.changeThisStateToEdit.bind(Object(m.a)(n)),n.confirmEditAndUpdateExpenses=n.confirmEditAndUpdateExpenses.bind(Object(m.a)(n)),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){(0,this.props.fetchApi)(),this.localStorageToReduxState()}},{key:"localStorageToReduxState",value:function(){var e=this.props.getLocalStorage,t=JSON.parse(localStorage.getItem("expenses"));return t?e(t):null}},{key:"handleChange",value:function(e){var t=this,a=e.target,n=a.name,r=a.value;this.setState(Object(u.a)({},n,r),(function(){return t.validateForm()}))}},{key:"validateForm",value:function(){var e=this.state,t=e.value,a=e.description,n=parseFloat(t),r=a.length>=2,i=(/\S+\.\S+/.test(n)||/\S+/.test(n))&&n>0;this.setState({isDisabled:!(r&&i)})}},{key:"handleClick",value:function(){var e=Object(x.a)(j.a.mark((function e(){var t,a,n,r,i,c,o,l,s,u,d,p,m;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a=t.updateExpenses,n=t.wallet.expenses,r=t.requestApi,i=this.state,c=i.value,o=i.description,l=i.currency,s=i.method,u=i.tag,r(!0),e.next=5,S();case 5:(d=e.sent)?(p=parseFloat(c).toFixed(2),m=n.length,a({id:m,value:p,description:o,currency:l,method:s,tag:u,exchangeRates:d}),this.setState({value:"",description:"",currency:"USD",method:"Dinheiro",tag:"Alimenta\xe7\xe3o",isDisabled:!0,errorCurrencyApi:!1}),A(this.props)):this.setState({errorCurrencyApi:!0}),r(!1);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"changeThisStateToEdit",value:function(e,t){var a=this.props.editExpense,n=e.value,r=e.description,i=e.currency,c=e.method,o=e.tag,l=document.getElementById("value-input");a(t),this.setState({value:n,description:r,currency:i,method:c,tag:o},(function(){return l.focus()}))}},{key:"confirmEditAndUpdateExpenses",value:function(){var e=Object(x.a)(j.a.mark((function e(){var t,a,n,r,i,c,o,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.confirmEditExpense,a=this.state,n=a.value,r=a.description,i=a.currency,c=a.method,o=a.tag,l=parseFloat(n).toFixed(2),e.next=5,t({value:l,description:r,currency:i,method:c,tag:o});case 5:this.setState({value:"",description:"",currency:"USD",method:"Dinheiro",tag:"Alimenta\xe7\xe3o",isDisabled:!0}),A(this.props);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"backToLogin",value:function(e,t){""===e&&t.push("/Trybe-Projeto_17-Trybe_Wallet")}},{key:"render",value:function(){var e=this.handleChange,t=this.handleClick,a=this.changeThisStateToEdit,n=this.confirmEditAndUpdateExpenses,i=this.backToLogin,c=this.props,o=c.email,l=c.wallet,s=l.isFetching,u=l.error,d=c.history,p=this.state,m=p.value,h=p.description,E=p.currency,b=p.method,v=p.tag,f=p.isDisabled,y=p.errorCurrencyApi;return r.a.createElement("div",{className:"wallet-section"},i(o,d),r.a.createElement(C,null),s||u?r.a.createElement("p",{className:"loading"},"Carregando..."):r.a.createElement(r.a.Fragment,null,r.a.createElement(N,{value:m,description:h,currency:E,method:b,tag:v,isDisabled:f,handleChange:e,handleClick:t,confirmEditAndUpdateExpenses:n}),r.a.createElement(D,{changeThisStateToEdit:a,errorCurrencyApi:y})),u?r.a.createElement("h2",{className:"erro-api"},"Ops, ocorreu um erro. Recarregue sua p\xe1gina!"):null)}}]),a}(r.a.Component)),R=Object(l.b)((function(e){return{wallet:e.wallet,email:e.user.user.email}}),(function(e){return{fetchApi:function(){return e((function(e){return e(b(!0)),fetch("https://economia.awesomeapi.com.br/json/all").then((function(e){return e.json()})).then((function(t){var a=Object.keys(t).filter((function(e){return"USDT"!==e}));return e({type:"GET_API",payload:a})})).catch((function(){return e({type:"FAILED_API",payload:!0})}))}))},getLocalStorage:function(t){return e({type:"LOCAL_STORAGE",payload:t})},requestApi:function(t){return e(b(t))},updateExpenses:function(t){return e({type:"UPDATE_EXPENSES",payload:t})},editExpense:function(t){return e({type:"EDIT_EXPENSE",payload:t})},confirmEditExpense:function(t){return e({type:"CONFIRM_EDIT_EXPENSE",payload:t})}}}))(_);var I=function(){return r.a.createElement("div",null,r.a.createElement(s.c,null,r.a.createElement(s.a,{exact:!0,path:"/Trybe-Projeto_17-Trybe_Wallet",render:function(e){return r.a.createElement(g,e)}}),r.a.createElement(s.a,{exact:!0,path:"/Trybe-Projeto_17-Trybe_Wallet/carteira",render:function(e){return r.a.createElement(R,e)}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var P=a(14),L=a(31),U=a(32),M={user:{email:""}},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return{user:{email:t.payload}};default:return e}},W=a(33),B=a(3),X={isFetching:!0,currencies:[],expenses:[],idToEdit:0,editor:!1,error:!1};function G(e,t){return e.expenses.filter((function(e,a){return a!==parseInt(t,10)}))}function J(e,t,a){return e.map((function(e,n){return n===t?Object(B.a)(Object(B.a)({},e),a):e}))}var q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOCAL_STORAGE":return Object(B.a)(Object(B.a)({},e),{},{expenses:t.payload});case"REQUEST_API":return Object(B.a)(Object(B.a)({},e),{},{isFetching:t.payload});case"GET_API":return Object(B.a)(Object(B.a)({},e),{},{currencies:t.payload,isFetching:!1,error:!1});case"FAILED_API":return Object(B.a)(Object(B.a)({},e),{},{isFetching:!1,error:!0});case"UPDATE_EXPENSES":return Object(B.a)(Object(B.a)({},e),{},{expenses:[].concat(Object(W.a)(e.expenses),[t.payload])});case"REMOVE_EXPENSE":return Object(B.a)(Object(B.a)({},e),{},{expenses:G(e,t.payload)});case"EDIT_EXPENSE":return Object(B.a)(Object(B.a)({},e),{},{editor:!0,idToEdit:t.payload});case"CONFIRM_EDIT_EXPENSE":return Object(B.a)(Object(B.a)({},e),{},{expenses:J(e.expenses,e.idToEdit,t.payload),editor:!1,idToEdit:null});default:return e}},z=Object(P.combineReducers)({user:V,wallet:q}),Q=Object(P.createStore)(z,Object(L.composeWithDevTools)(Object(P.applyMiddleware)(U.a)));c.a.render(r.a.createElement(o.a,null,r.a.createElement(l.a,{store:Q},r.a.createElement(I,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[34,1,2]]]);
//# sourceMappingURL=main.de1b522e.chunk.js.map